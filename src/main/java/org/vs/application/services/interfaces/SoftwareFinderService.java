package org.vs.application.services.interfaces;

import org.vs.application.model.CVEResult;
import org.vs.utils.VSUtils;

import java.io.IOException;
import java.util.List;

import static org.vs.utils.VSUtils.INSTALLED_SOFTWARE_FILE_NAME_JSON;

public interface SoftwareFinderService {

    String WIN_COMMAND_WITH_FILE = "/c wmic product get name,version /format:csv > " + VSUtils.FILE_PATH + "${file}";
    String WIN_MD_COMMAND_WITHOUT_FILE = "/c wmic product get name,version /format:csv";
    String WIN_PS_COMMAND_WITHOUT_FILE = "/c winget export -o " + VSUtils.FILE_PATH + INSTALLED_SOFTWARE_FILE_NAME_JSON + " --include-versions";

    String USE_PROGRAM_CMD = "cmd.exe";
    String WIN_PS_COMMAND_WITH_FILE = "/c winget export -o " + VSUtils.FILE_PATH + INSTALLED_SOFTWARE_FILE_NAME_JSON + " --include-versions";

    boolean isWriteEnabled();

    List<CVEResult> findInstalledSoftware() throws IOException, InterruptedException;

    void parseJsonResults(List<CVEResult> results) throws IOException;
}
